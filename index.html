<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluaci贸n 360掳 Product Owners - Resultados</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #00008F 0%, #0000B8 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 143, 0.3);
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .personas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .persona-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
        }
        
        .persona-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 143, 0.2);
            border-color: #00008F;
        }
        
        .persona-card.active {
            border-color: #E4002B;
            background: #f8f9ff;
        }
        
        .persona-name {
            font-size: 1.4em;
            font-weight: bold;
            color: #00008F;
            margin-bottom: 15px;
        }
        
        .evaluaciones-count {
            background: #E4002B;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 10px;
            font-size: 0.9em;
            font-weight: bold;
        }
        
        .detalle-container {
            background: white;
            padding: 35px;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: none;
        }
        
        .detalle-container.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .detalle-header {
            border-bottom: 3px solid #00008F;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .detalle-nombre {
            font-size: 2em;
            color: #00008F;
            font-weight: bold;
        }
        
        .charts-section {
            max-width: 500px;
            margin: 0 auto 40px auto;
        }
        
        .chart-container {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #e0e5ff;
        }
        
        .chart-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #00008F;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .competencia-section {
            margin-bottom: 40px;
            border: 2px solid #e0e5ff;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .competencia-header {
            background: linear-gradient(135deg, #00008F 0%, #0000B8 100%);
            color: white;
            padding: 20px;
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .competencia-content {
            padding: 25px;
        }
        
        .evaluacion-item {
            background: #f8f9ff;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            border-left: 5px solid #00008F;
        }
        
        .calificacion {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: bold;
            margin-bottom: 12px;
            font-size: 0.95em;
        }
        
        .calificacion.shu {
            background: #4CAF50;
            color: white;
        }
        
        .calificacion.ha {
            background: #FF9800;
            color: white;
        }
        
        .calificacion.ri {
            background: #F44336;
            color: white;
        }
        
        .calificacion.no-info {
            background: #9E9E9E;
            color: white;
        }
        
        .comentario {
            color: #444;
            line-height: 1.6;
            margin-top: 10px;
            font-style: italic;
            padding: 12px;
            background: white;
            border-radius: 8px;
        }
        
        .evaluador {
            color: #E4002B;
            font-weight: bold;
            margin-top: 10px;
            font-size: 0.95em;
        }
        
        .resumen-general {
            background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border: 2px solid #00008F;
        }
        
        .resumen-title {
            font-size: 1.5em;
            color: #00008F;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .resumen-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .stat-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #00008F;
        }

        @media (max-width: 768px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1> Evaluaci贸n 360掳 - Resultados</h1>
            <p>Valoraci贸n de competencias - Product Owners</p>
        </div>
        
        <div class="personas-grid" id="personasGrid"></div>
        
        <div class="detalle-container" id="detalleContainer"></div>
    </div>

    <script>
        const competencias = [
            "Conceptualizaci贸n: Puedo escuchar al usuario, entender y conceptualizar su necesidad funcional",
            "Balance entre panorama estrat茅gico y operativo: Capacidad de an谩lisis de impacto dentro de la estrategia del negocio",
            "Comunicaci贸n y Liderazgo: Tener la capacidad de transmitir mensajes claros y habilitar a los equipos",
            "Organizaci贸n y planeaci贸n: Capacidad de crear y ejecutar planes de trabajo eficientes",
            "Priorizaci贸n de Victorias Tempranas"
        ];

        const evaluaciones = [
            {persona: "Aura Mar铆a Lara", evaluador: "M.C", calificaciones: ["SHU (Maestro) Alto", "HA (Practicante) Medio", "HA (Practicante) Medio", "SHU (Maestro) Alto", "HA (Practicante) Medio"], comentarios: ["", "", "", "", "", "Considero que Aura es muy h谩bil conceptualizando las necesidades funcionales y al tener conocimiento de diferentes procesos logra establecer entregables de valor. \nAdmiro la capacidad de manejar tantos frentes a la vez y tenerlo todo controlado, por lo que pienso que es Shu (Maestro) en la planeaci贸n y organizaci贸n. \nSi bien no considero tiene desarrollada la comunicaci贸n y liderazgo tal vez ah铆 hay oportunidades de mejora para plantear su punto de vista m谩s \"fuerte y defenderlo\" y dar mensajes m谩s contundentes. "]},
            {persona: "Maria Zarate", evaluador: "M.C", calificaciones: ["SHU (Maestro) Alto", "HA (Practicante) Medio", "HA (Practicante) Medio", "HA (Practicante) Medio", "No Tengo Suficiente Informaci贸n"], comentarios: ["", "", "", "", "", "Creo que Pau es muy pila y tiene la habilidad de conceptualizar en entregables de valor las necesidades del negocio, creo que es muy organizada y que tiene habilidades destacables para hacer PPTs vendedoras. No tengo tanto contacto con ella en el d铆a a d铆a, pero en algunos escenarios he visto que puede mejorar la comunicaci贸n para llevar mensajes m谩s puntuales y que tengan un objetivo"]},
            {persona: "Laura Cabieles", evaluador: "", calificaciones: ["HA (Practicante) Medio", "SHU (Maestro) Alto", "HA (Practicante) Medio", "HA (Practicante) Medio", "HA (Practicante) Medio"], comentarios: ["considero que Lau tiene una capacidad de conceptualizar las necesidades desde el punto de vista estrat茅gico, si bien en su Rol no es necesario que haga conceptualizaci贸n para propuestas de procesos o soluciones, s铆 se interesa por entender y cuestionar las soluciones planteadas", "Creo que la habilidad estrat茅gica de Lau para organizar al equipo y ponernos foco para trabajar en lo m谩s importante y presentarlo estrat茅gicamente ante V.P ha hecho que la percepci贸n de nuestro trabajo y los resultados sea muy bueno", "Lau es puntual y clara en los mensajes estrat茅gicos que quiere transmitir. ", "Si bien Lau no organiza el plan de trabajo de cada entregable, s铆 organiza la asignaci贸n de nuestros entregables y el seguimiento realizado nos permite tener visual recurrente de los avances y de las alertas", "", ""]}
        ];

        function agruparPorPersona() {
            const grouped = {};
            evaluaciones.forEach(ev => {
                if (!grouped[ev.persona]) {
                    grouped[ev.persona] = [];
                }
                grouped[ev.persona].push(ev);
            });
            return grouped;
        }

        function calcularEstadisticas(evaluacionesPersona) {
            const counts = { shu: 0, ha: 0, ri: 0, noInfo: 0 };
            
            evaluacionesPersona.forEach(ev => {
                ev.calificaciones.forEach(cal => {
                    if (cal.includes("SHU")) counts.shu++;
                    else if (cal.includes("HA")) counts.ha++;
                    else if (cal.includes("RI")) counts.ri++;
                    else counts.noInfo++;
                });
            });

            return { counts, total: evaluacionesPersona.length };
        }

        function renderPersonas() {
            const grid = document.getElementById('personasGrid');
            const grouped = agruparPorPersona();
            
            // Agregar tarjeta de consolidado general
            const consolidadoCard = document.createElement('div');
            consolidadoCard.className = 'persona-card';
            consolidadoCard.style.background = 'linear-gradient(135deg, #00008F 0%, #0000B8 100%)';
            consolidadoCard.style.color = 'white';
            consolidadoCard.innerHTML = `
                <div class="persona-name" style="color: white;"> Consolidado del Equipo</div>
                <div class="evaluaciones-count" style="background: #E4002B;">Ver an谩lisis general</div>
            `;
            consolidadoCard.onclick = () => mostrarConsolidado();
            grid.appendChild(consolidadoCard);
            
            Object.keys(grouped).sort().forEach(persona => {
                const stats = calcularEstadisticas(grouped[persona]);
                const card = document.createElement('div');
                card.className = 'persona-card';
                card.innerHTML = `
                    <div class="persona-name">${persona}</div>
                    <div class="evaluaciones-count">${stats.total} evaluaciones</div>
                `;
                card.onclick = () => mostrarDetalle(persona, grouped[persona]);
                grid.appendChild(card);
            });
        }

        let chartsInstances = [];

        function mostrarDetalle(persona, evaluacionesPersona) {
            document.querySelectorAll('.persona-card').forEach(card => {
                card.classList.remove('active');
                if (card.querySelector('.persona-name').textContent === persona) {
                    card.classList.add('active');
                }
            });

            const container = document.getElementById('detalleContainer');
            const stats = calcularEstadisticas(evaluacionesPersona);
            
            chartsInstances.forEach(chart => chart.destroy());
            chartsInstances = [];

            let html = `
                <div class="detalle-header">
                    <div class="detalle-nombre">${persona}</div>
                </div>

                <div class="resumen-general">
                    <div class="resumen-title">Resumen General</div>
                    <div class="resumen-stats">
                        <div class="stat-item">
                            <div class="stat-label">Total Evaluaciones</div>
                            <div class="stat-value">${stats.total}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">SHU (Maestro)</div>
                            <div class="stat-value" style="color: #4CAF50">${stats.counts.shu}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">HA (Practicante)</div>
                            <div class="stat-value" style="color: #FF9800">${stats.counts.ha}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">RI (Aprendiz)</div>
                            <div class="stat-value" style="color: #F44336">${stats.counts.ri}</div>
                        </div>
                    </div>
                </div>
            `;

            competencias.forEach((comp, idx) => {
                let shuCount = 0, haCount = 0, riCount = 0, noInfoCount = 0;
                evaluacionesPersona.forEach(ev => {
                    const cal = ev.calificaciones[idx];
                    if (cal.includes('SHU')) shuCount++;
                    else if (cal.includes('HA')) haCount++;
                    else if (cal.includes('RI')) riCount++;
                    else noInfoCount++;
                });

                html += `
                    <div class="competencia-section">
                        <div class="competencia-header">${idx + 1}. ${comp}</div>
                        <div class="competencia-content">
                            <div class="chart-container" style="max-width: 400px; margin: 0 auto 30px auto;">
                                <div class="chart-title">Distribuci贸n en esta Competencia</div>
                                <canvas id="chartComp${idx}"></canvas>
                            </div>
                `;

                evaluacionesPersona.forEach((ev, evIdx) => {
                    const cal = ev.calificaciones[idx];
                    const com = ev.comentarios[idx];
                    
                    let calClass = 'no-info';
                    if (cal.includes('SHU')) calClass = 'shu';
                    else if (cal.includes('HA')) calClass = 'ha';
                    else if (cal.includes('RI')) calClass = 'ri';

                    html += `
                        <div class="evaluacion-item">
                            <div><span class="calificacion ${calClass}">${cal}</span></div>
                            ${com ? `<div class="comentario">"${com}"</div>` : '<div class="comentario" style="color: #999; font-style: italic;">Sin comentario</div>'}
                            <div class="evaluador">Evaluador: ${ev.evaluador || 'An贸nimo'}</div>
                        </div>
                    `;
                });

                html += `
                        </div>
                    </div>
                `;
            });

            html += `
                <div class="competencia-section">
                    <div class="competencia-header" style="background: linear-gradient(135deg, #E4002B 0%, #C00024 100%);"> Feedback General</div>
                    <div class="competencia-content">
            `;

            evaluacionesPersona.forEach((ev, evIdx) => {
                const comGeneral = ev.comentarios[5];
                
                html += `
                    <div class="evaluacion-item">
                        ${comGeneral ? `<div class="comentario">"${comGeneral}"</div>` : '<div class="comentario" style="color: #999; font-style: italic;">Sin comentario general</div>'}
                        <div class="evaluador">Evaluador: ${ev.evaluador || 'An贸nimo'}</div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            container.innerHTML = html;
            container.classList.add('active');

            setTimeout(() => {
                competencias.forEach((comp, idx) => {
                    let shuCount = 0, haCount = 0, riCount = 0, noInfoCount = 0;
                    evaluacionesPersona.forEach(ev => {
                        const cal = ev.calificaciones[idx];
                        if (cal.includes('SHU')) shuCount++;
                        else if (cal.includes('HA')) haCount++;
                        else if (cal.includes('RI')) riCount++;
                        else noInfoCount++;
                    });

                    const ctx = document.getElementById(`chartComp${idx}`);
                    if (ctx) {
                        const chart = new Chart(ctx, {
                            type: 'pie',
                            data: {
                                labels: ['SHU (Maestro)', 'HA (Practicante)', 'RI (Aprendiz)', 'Sin Informaci贸n'],
                                datasets: [{
                                    data: [shuCount, haCount, riCount, noInfoCount],
                                    backgroundColor: ['#4CAF50', '#FF9800', '#F44336', '#9E9E9E']
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: {
                                            font: {
                                                size: 11
                                            }
                                        }
                                    }
                                }
                            }
                        });
                        chartsInstances.push(chart);
                    }
                });
            }, 100);

            container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function mostrarConsolidado() {
            document.querySelectorAll('.persona-card').forEach(card => {
                card.classList.remove('active');
                if (card.querySelector('.persona-name').textContent.includes('Consolidado')) {
                    card.classList.add('active');
                }
            });

            const container = document.getElementById('detalleContainer');
            
            chartsInstances.forEach(chart => chart.destroy());
            chartsInstances = [];

            let totalSHU = 0, totalHA = 0, totalRI = 0, totalNoInfo = 0;
            evaluaciones.forEach(ev => {
                ev.calificaciones.forEach(cal => {
                    if (cal.includes("SHU")) totalSHU++;
                    else if (cal.includes("HA")) totalHA++;
                    else if (cal.includes("RI")) totalRI++;
                    else totalNoInfo++;
                });
            });

            const totalCalificaciones = totalSHU + totalHA + totalRI + totalNoInfo;
            const personas = [...new Set(evaluaciones.map(e => e.persona))];

            const resultadosPorCompetencia = competencias.map((comp, idx) => {
                let shu = 0, ha = 0, ri = 0, noInfo = 0;
                evaluaciones.forEach(ev => {
                    const cal = ev.calificaciones[idx];
                    if (cal.includes("SHU")) shu++;
                    else if (cal.includes("HA")) ha++;
                    else if (cal.includes("RI")) ri++;
                    else noInfo++;
                });
                const total = shu + ha + ri;
                const porcentajeSHU = total > 0 ? ((shu / total) * 100).toFixed(1) : 0;
                return { competencia: comp, shu, ha, ri, noInfo, porcentajeSHU: parseFloat(porcentajeSHU) };
            });

            const fortalezas = [...resultadosPorCompetencia].sort((a, b) => b.porcentajeSHU - a.porcentajeSHU).slice(0, 3);
            const oportunidades = [...resultadosPorCompetencia].sort((a, b) => a.porcentajeSHU - b.porcentajeSHU).slice(0, 3);

            let html = `
                <div class="detalle-header">
                    <div class="detalle-nombre"> Consolidado del Equipo</div>
                </div>

                <div class="resumen-general">
                    <div class="resumen-title">Resumen General</div>
                    <div class="resumen-stats">
                        <div class="stat-item">
                            <div class="stat-label">Total Personas</div>
                            <div class="stat-value">${personas.length}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Total Evaluaciones</div>
                            <div class="stat-value">${evaluaciones.length}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">SHU (Maestro)</div>
                            <div class="stat-value" style="color: #4CAF50">${totalSHU}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">HA (Practicante)</div>
                            <div class="stat-value" style="color: #FF9800">${totalHA}</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">RI (Aprendiz)</div>
                            <div class="stat-value" style="color: #F44336">${totalRI}</div>
                        </div>
                    </div>
                </div>

                <div class="charts-section">
                    <div class="chart-container">
                        <div class="chart-title">Distribuci贸n General del Equipo</div>
                        <canvas id="chartConsolidadoGeneral"></canvas>
                    </div>
                </div>

                <div class="competencia-section">
                    <div class="competencia-header" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);"> Top 3 Fortalezas del Equipo</div>
                    <div class="competencia-content">
            `;

            fortalezas.forEach((f, idx) => {
                html += `
                    <div class="evaluacion-item">
                        <div style="font-size: 1.2em; font-weight: bold; color: #00008F; margin-bottom: 10px;">
                            ${idx + 1}. ${f.competencia}
                        </div>
                        <div style="font-size: 1.1em; color: #4CAF50; font-weight: bold;">
                            ${f.porcentajeSHU}% en nivel maestro
                        </div>
                        <div style="margin-top: 10px; color: #666;">
                            SHU: ${f.shu} | HA: ${f.ha} | RI: ${f.ri}
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>

                <div class="competencia-section">
                    <div class="competencia-header" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);"> Top 3 Oportunidades de Mejora</div>
                    <div class="competencia-content">
            `;

            oportunidades.forEach((o, idx) => {
                html += `
                    <div class="evaluacion-item">
                        <div style="font-size: 1.2em; font-weight: bold; color: #00008F; margin-bottom: 10px;">
                            ${idx + 1}. ${o.competencia}
                        </div>
                        <div style="font-size: 1.1em; color: #FF9800; font-weight: bold;">
                            ${o.porcentajeSHU}% en nivel maestro
                        </div>
                        <div style="margin-top: 10px; color: #666;">
                            SHU: ${o.shu} | HA: ${o.ha} | RI: ${o.ri}
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>

                <div class="competencia-section">
                    <div class="competencia-header"> Detalle por Competencia</div>
                    <div class="competencia-content" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
            `;

            resultadosPorCompetencia.forEach((r, idx) => {
                html += `
                    <div style="background: #f8f9ff; padding: 20px; border-radius: 10px; border: 2px solid #e0e5ff;">
                        <div style="font-weight: bold; color: #00008F; margin-bottom: 15px; font-size: 1.1em;">
                            ${idx + 1}. ${r.competencia}
                        </div>
                        <canvas id="chartCompConsolidado${idx}" style="max-height: 200px;"></canvas>
                        <div style="margin-top: 15px; text-align: center;">
                            <div style="font-size: 1.3em; font-weight: bold; color: #4CAF50;">
                                ${r.porcentajeSHU}% maestro
                            </div>
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                SHU: ${r.shu} | HA: ${r.ha} | RI: ${r.ri}
                            </div>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            container.innerHTML = html;
            container.classList.add('active');

            setTimeout(() => {
                const ctxGeneral = document.getElementById('chartConsolidadoGeneral');
                if (ctxGeneral) {
                    const chartGeneral = new Chart(ctxGeneral, {
                        type: 'pie',
                        data: {
                            labels: ['SHU (Maestro)', 'HA (Practicante)', 'RI (Aprendiz)', 'Sin Informaci贸n'],
                            datasets: [{
                                data: [totalSHU, totalHA, totalRI, totalNoInfo],
                                backgroundColor: ['#4CAF50', '#FF9800', '#F44336', '#9E9E9E']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                    chartsInstances.push(chartGeneral);
                }

                resultadosPorCompetencia.forEach((r, idx) => {
                    const ctx = document.getElementById(`chartCompConsolidado${idx}`);
                    if (ctx) {
                        const chart = new Chart(ctx, {
                            type: 'pie',
                            data: {
                                labels: ['SHU', 'HA', 'RI', 'Sin Info'],
                                datasets: [{
                                    data: [r.shu, r.ha, r.ri, r.noInfo],
                                    backgroundColor: ['#4CAF50', '#FF9800', '#F44336', '#9E9E9E']
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: true,
                                plugins: {
                                    legend: {
                                        position: 'bottom',
                                        labels: {
                                            font: { size: 10 }
                                        }
                                    }
                                }
                            }
                        });
                        chartsInstances.push(chart);
                    }
                });
            }, 100);

            container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        renderPersonas();
    </script>
</body>
</html>
